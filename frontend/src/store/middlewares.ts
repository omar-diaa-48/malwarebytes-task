import { isAsyncThunkAction, isRejectedWithValue, Middleware } from "@reduxjs/toolkit";
import { toast } from "react-toastify";

export const rtkQueryError: Middleware = (api) => (next) => (action) => {
	if (isAsyncThunkAction(action)) {

		let isDimissed = false;

		if (isRejectedWithValue(action) && !isDimissed) {
			let message = 'Invalid operation'

			console.log({ action });

			if (action?.payload?.response?.data?.message) {
				message = action?.payload?.response?.data?.message;
			}

			toast(message, { type: "error" })
		}

	}

	return next(action)
}